import{d as H,r as D,o as L,c as R,w as T,b as j,l as N,m as h,P as U,V as f,L as X,n as E,q as S,s as F,A as G,g as J,_ as K}from"./index-be16815d.js";const Q=H({__name:"Drawing",setup(W,{expose:C}){let c;const k=D(),B=D(!1),I=D("80%");let V;const O=d=>{B.value=!0,V=d},P=()=>{c==null&&(c=new N(k.value)),c.root.clear();let d=new h,m=U.BasisX.angleTo(V.length_dir);d.makeRotationAxis(new f(0,0,1),m);let o=V.edgesObject3D.clone();o.applyMatrix4(d),o.traverse(function(l){if(l instanceof X){let a=l.clone();a.applyMatrix4(d),c.root.add(a)}l instanceof E&&l.material==S.setMaterial&&(l.material=S.modelTransparentMaterial)});let x=o.clone(),u=o.clone(),p=new F(o);p.geometry.computeBoundingBox();let n=p.geometry.boundingBox,t=new f((n.max.x+n.min.x)/2,(n.max.y+n.min.y)/2,(n.max.z+n.min.z)/2),_=new h;_.setPosition(n.max.x-n.min.x+2e3,0,0),o.applyMatrix4(_),c.root.add(o);let b=A(-Math.PI/2,new f(0,1,0),t,new f((n.max.x-n.min.x)/2+1e3,0,0));x.applyMatrix4(b),c.root.add(x);let y=A(-Math.PI/2,new f(1,0,0),t,new f(0,-((n.max.y-n.min.y)/2+1e3),0));u.applyMatrix4(y),c.root.add(u),c.lookBoundingBox()},q=()=>{c!=null&&(c.root.clear(),c.enableRender(),G.instance.resetOperation())};function A(d,m,o=null,x=null){let u=0,p=u,n=p;o!=null&&(n=o.x,p=o.y,u=o.z);let t=new f(n,p,u),_=new h,b=d,y=Math.cos(b),l=Math.sin(b),a=m.x,r=m.y,s=m.z,w=a*a,g=r*r,M=s*s,z=w+g+M;if(z!=0){let v=Math.sqrt(z);a/=v,r/=v,s/=v,w/=z,g/=z,M/=z}let i=1-y,e=[];return e[0]=[],e[0][0]=y+i*w,e[0][1]=a*r*i+s*l,e[0][2]=a*s*i-r*l,e[1]=[],e[1][0]=a*r*i-s*l,e[1][1]=y+i*g,e[1][2]=r*s*i+a*l,e[2]=[],e[2][0]=a*s*i+r*l,e[2][1]=r*s*i-a*l,e[2][2]=y+i*M,e[3]=[],e[3][0]=(t.x*(g+M)-a*(t.y*r+t.z*s))*i+(t.y*s-t.z*r)*l,e[3][1]=(t.y*(w+M)-r*(t.x*a+t.z*s))*i+(t.z*a-t.x*s)*l,e[3][2]=(t.z*(w+g)-s*(t.x*a+t.y*r))*i+(t.x*r-t.y*a)*l,x!=null&&(e[3][0]+=x.x,e[3][1]+=x.y,e[3][2]+=x.z),_.set(e[0][0],e[1][0],e[2][0],e[3][0],e[0][1],e[1][1],e[2][1],e[3][1],e[0][2],e[1][2],e[2][2],e[3][2],0,0,0,0),_}return C({dialogVisible:B,showDrawing:O}),(d,m)=>{const o=J("el-drawer");return L(),R(o,{modelValue:B.value,"onUpdate:modelValue":m[0]||(m[0]=x=>B.value=x),size:I.value,onOpened:P,onClose:q,title:"图纸查看"},{default:T(()=>[j("div",{ref_key:"refSence2d",ref:k,class:"sence2dDraw"},null,512)]),_:1},8,["modelValue","size"])}}});const Z=K(Q,[["__scopeId","data-v-7f060a4f"]]);export{Z as default};
